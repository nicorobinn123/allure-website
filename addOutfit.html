<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Allure - Add New Outfit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
  </style>
</head>
<body class="flex min-h-screen bg-stone-100 text-stone-800">

  <!-- Sidebar -->
  <aside class="w-20 bg-white border-r border-stone-200 flex flex-col items-center py-8 shadow-lg">
    <nav class="flex-grow space-y-8">
      <!-- Home -->
      <a href="index.html" class="block p-2 rounded-full hover:bg-stone-200 transition-colors duration-200">
        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 9.75L12 3l9 6.75V21a1.5 1.5 0 01-1.5 1.5H4.5A1.5 1.5 0 013 21V9.75z"/>
        </svg>
      </a>
      <!-- Profile -->
      <a href="profile.html" class="block p-2 rounded-full hover:bg-stone-200 transition-colors duration-200">
        <svg class="w-6 h-6 text-stone-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
        </svg>
      </a>
      <!-- Calendar -->
      <a href="calendar.html" class="block p-2 rounded-full hover:bg-stone-200 transition-colors duration-200">
        <svg class="w-6 h-6 text-stone-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M8 7V3m8 4V3M4 11h16M4 19h16M4 7h16v14a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/>
        </svg>
      </a>
      <!-- Gallery -->
      <a href="gallery.html" class="block p-2 rounded-full hover:bg-stone-200 transition-colors duration-200">
        <svg class="w-6 h-6 text-stone-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 6c0-1.657 1.343-3 3-3s3 1.343 3 3c0 1.15-.622 2.158-1.556 2.675L12 12l-4.444-3.325A3.002 3.002 0 016 6c0-1.657 1.343-3 3-3s3 1.343 3 3"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 20h16l-8-6-8 6z"/>
        </svg>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8 overflow-y-auto">
    <!-- Header -->
    <header class="flex justify-between items-center mb-12">
      <div class="flex items-center space-x-2">
        <div class="w-8 h-8 rounded-full bg-stone-300"></div>
        <span class="text-lg font-medium text-stone-500">Hello, Name!</span>
      </div>
      <span class="text-4xl font-light text-stone-800">allure</span>
    </header>

    <!-- Card Container -->
    <div class="space-y-6">
      <!-- Back Button + Title -->
      <div class="flex items-center space-x-4">
        <button onclick="goBack()" class="flex items-center space-x-2 text-stone-500 hover:text-stone-800 transition-colors duration-200">
          <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
          <span class="font-medium">Back</span>
        </button>
        <div class="flex items-center space-x-2 flex-grow justify-center">
          <svg class="w-8 h-8 text-stone-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 2a2 2 0 00-2 2 2 2 0 104 0 2 2 0 00-2-2zm0 4v2l-6 4v8h12v-8l-6-4z"/>
          </svg>
          <h2 class="text-xl font-semibold uppercase tracking-wide">Add Your New Outfit!</h2>
        </div>
      </div>

      <!-- Main Card -->
      <div class="bg-white p-6 rounded-2xl shadow-lg border border-stone-200 flex flex-col lg:flex-row gap-8">
        <!-- Left: Upload + Dropdowns -->
        <div class="flex-1 space-y-6">
          <!-- Upload Box -->
          <div id="uploadBox" class="bg-stone-200 rounded-xl p-8 flex flex-col items-center justify-center space-y-2 text-center h-96 cursor-pointer">
            <img src="https://img.icons8.com/ios/100/000000/t-shirt.png" alt="Shirt placeholder" class="w-20 h-20 opacity-70">
            <p class="text-stone-600 font-medium">+ Add Images</p>
            <p class="text-xs text-stone-500">*Format must be .JPG / .PNG / .HEIF</p>
          </div>
          <input type="file" id="imageInput" accept=".jpg,.jpeg,.png,.heif" class="hidden">

          <!-- Dropdowns -->
          <div class="grid grid-cols-2 gap-4">
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Type">
              <option value="" disabled selected>Type</option>
              <option>Top</option><option>Bottom</option><option>Outerwear</option>
            </select>
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Model">
              <option value="" disabled selected>Model</option>
              <option>Shirt</option><option>Dress</option><option>Pants</option>
            </select>
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Color">
              <option value="" disabled selected>Color</option>
              <option>Black</option><option>White</option><option>Beige</option>
            </select>
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Thickness">
              <option value="" disabled selected>Thickness</option>
              <option>Thin</option><option>Medium</option><option>Thick</option>
            </select>
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Material">
              <option value="" disabled selected>Material</option>
              <option>Cotton</option><option>Polyester</option><option>Wool</option>
            </select>
            <select class="w-full px-4 py-2 bg-stone-200 rounded-lg" data-category="Motive">
              <option value="" disabled selected>Motive</option>
              <option>Plain</option><option>Striped</option><option>Checked</option>
            </select>
          </div>
        </div>

        <!-- Right: Name + Info + Next -->
        <div class="flex-1 space-y-6">
          <!-- Name -->
          <div>
            <h3 class="text-xl font-semibold mb-2">Name</h3>
            <input id="outfitName" type="text" placeholder="Enter outfit name"
              class="w-full px-4 py-2 rounded-lg bg-stone-200 border border-stone-300">
          </div>

          <!-- Selected Tags -->
          <div>
            <h3 class="text-xl font-semibold mb-4">Selected data description</h3>
            <div id="selected-tags" class="flex flex-wrap gap-2"></div>
          </div>

          <!-- Additional Info -->
          <div>
            <h3 class="text-xl font-semibold mb-4">Additional Information <span class="text-sm font-normal text-stone-500">(Optional)</span></h3>
            <textarea id="notes" class="w-full h-32 p-4 rounded-lg bg-stone-200 resize-none"></textarea>
          </div>

          <!-- Error + Next -->
          <div class="mt-8 flex flex-col items-end">
            <div id="error-message" class="text-red-500 text-sm mb-2 hidden"></div>
            <button id="nextBtn" class="px-8 py-3 bg-stone-900 text-white rounded-full font-semibold hover:bg-stone-800 transition-colors duration-200 mt-2">
              Next
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

<script>
const dropdowns = document.querySelectorAll("select[data-category]");
const tagsContainer = document.getElementById("selected-tags");
const nextBtn = document.getElementById("nextBtn");
const errorMessage = document.getElementById("error-message");
const outfitName = document.getElementById("outfitName");
const notesInput = document.getElementById("notes");
const uploadBox = document.getElementById("uploadBox");
const imageInput = document.getElementById("imageInput");

// Upload click
uploadBox.addEventListener("click", () => imageInput.click());

// Preview + validation
imageInput.addEventListener("change", (event) => {
  const file = event.target.files[0];
  if (!file) return;
  const validTypes = ["image/jpeg", "image/png", "image/heif"];
  if (!validTypes.includes(file.type)) {
    alert("Invalid file format! Please upload JPG, PNG, or HEIF.");
    imageInput.value = "";
    return;
  }
  const reader = new FileReader();
  reader.onload = (e) => {
    uploadBox.innerHTML = `<img src="${e.target.result}" class="object-cover w-full h-full rounded-xl">`;
  };
  reader.readAsDataURL(file);
});

// Update tags
function updateTags() {
  tagsContainer.innerHTML = "";
  dropdowns.forEach(d => {
    if (d.value !== "") {
      const tag = document.createElement("span");
      tag.textContent = d.value;
      tag.className = "px-3 py-1 bg-white border rounded-full shadow-sm text-gray-800";
      tagsContainer.appendChild(tag);
    }
  });
  if (Array.from(dropdowns).every(d => d.value !== "") && outfitName.value.trim() !== "")
    errorMessage.classList.add("hidden");
}
dropdowns.forEach(d => d.addEventListener("change", updateTags));
outfitName.addEventListener("input", updateTags);

// Next click
nextBtn.addEventListener("click", () => {
  const allDropdownsFilled = Array.from(dropdowns).every(d => d.value !== "");
  const nameFilled = outfitName.value.trim() !== "";
  
  if (!nameFilled || !allDropdownsFilled) {
    let msg = "";
    if (!nameFilled) msg += "Please enter a name for the outfit. ";
    if (!allDropdownsFilled) msg += "Please select an option for every category.";
    errorMessage.textContent = msg;
    errorMessage.classList.remove("hidden");
  } else {
    errorMessage.classList.add("hidden");

    // Collect data
    const outfit = {
      name: outfitName.value.trim(),
      notes: notesInput.value.trim(),
      tags: Array.from(dropdowns).map(d => d.value),
      image: uploadBox.querySelector("img") ? uploadBox.querySelector("img").src : null
    };

    // Save to localStorage
    localStorage.setItem("selectedOutfit", JSON.stringify(outfit));

    // Redirect to details
    window.location.href = "itemDetail.html";
  }
});

function goBack() { window.history.back(); }
</script>
</body>
</html>
